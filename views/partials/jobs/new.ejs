


<div class="page-container hidden" data-page-name="new">




<header>
    <h1>Add New Job</h1>
</header>

<main>
    <div class="job-data">
        <div class="data-header">
            <h4>Jobsite Information</h4>
        </div>

        <div id="output"></div>
        <div id="showAllBtn">SHOW ALL JOBS</div>
        <div class="add-form">

            <form id="addNewJob">
                <div class="data-item">
                    <input type="text" name="property.site_name" id="siteName" placeholder="Site Name">
                </div>

                <div class="data-item">
                    <select name="property.zoning" id="propertyType">
                    <option id="defaultJobZone" selected disabled hidden>Property Type (Required)</option>
                    <div class="options-list">
                        <option value="residential">Residential</option>
                        <option value="commercial">Commercial</option>
                        <option value="other">Other</option>
                    </div>
                    </select>
                </div>

                <div class="data-item">
                    <input type="text" name="property.address.line_1" id="jobAddr1" placeholder="Address Line 1">
                </div>
                <div class="data-item">
                    <input type="text" name="property.address.line_2" id="jobAddr2" placeholder="Address Line 2">
                </div>
                <div class="data-item">
                    <input type="text" name="property.address.city" id="jobCity" placeholder="City">
                </div>
                <div class="data-item">
                    <input type="text" name="property.address.state" id="jobState" placeholder="State">
                </div>
                <div class="data-item">
                    <input type="text" name="property.address.zip" id="jobZip" placeholder="Zip">
                </div>
                <div class="data-item">
                    <input type="text" name="property.address.country" id="jobCountry" placeholder="Country">
                </div>
                <div class="data-item"><button>Add New Job</button></div>

            </form>
        </div>

        <div class="data-row">
            <div class="data-item vert-stack">
                <span class="data-input-label">Start Date</span>
                <input type="date" name="jobsite.timeline.start" id="startDate" placeholder="Date Started">
            </div>
            <div class="data-item vert-stack">
                <span class="data-input-label">Finish Date</span>
                <input type="date" name="jobsite.timeline.finish" id="finishDate" placeholder="Date Finished">
            </div>
        </div>

        <div class="data-header">
            <h6>Permits</h6>
        </div>
        <div class="permits-list">
            <div class="permit-item"
                style="text-align: center; border-bottom: solid 1px orangered; margin-bottom: 10px;">
                <span class="permit-code" data-permit-code="12345">Code</span>
                <span class="permit-name" data-permit-name="0">Permit Name</span>
                <span class="permit-status" data-permit-status="0">Unsubmitted</span>
            </div>
            <div class="permit-item">
                <span class="permit-code" data-permit-code="12345">#12345</span>
                <span class="permit-name" data-permit-name="0">City Water Hookup</span>
                <span class="permit-status" data-permit-status="0">Unsubmitted</span>
            </div>
            <div class="permit-item">
                <span class="permit-code" data-permit-code="12345">#23451</span>
                <span class="permit-name" data-permit-name="0">City Gas Hookup</span>
                <span class="permit-status" data-permit-status="0">Approved</span>
            </div>
            <div class="permit-item">
                <span class="permit-code" data-permit-code="12345">#34512</span>
                <span class="permit-name" data-permit-name="0">City Electrical Hookup</span>
                <span class="permit-status" data-permit-status="0">Pending</span>
            </div>
        </div>
        <div class="add-form">
            <form id="addPermit" action="" method="post">
                <div class="data-item"><input type="text" name="jobsite_permit_code" placeholder="Permit Code"></div>
                <div class="data-item"><input type="text" name="jobsite_permit_name" placeholder="Permit Name"></div>
                <div class="dev-note">
                    <p>Create a Permit object before saving into DB, jobsite.permits: [ {permit_code: String,
                        permit_name: String, permit_status: { type: Number, default: 0 }, {Permit}, {Permit} ] (status
                        scale: 0 - 5. 0 = Not Submitted; 1 = Pending; 2 = Action Required; 3 = Approved; 4 = Approved
                        with Conditions; 5 = Unapproved</p>
                </div>
                <div class="data-item">
                    <button>Add Permit</button>
                </div>
            </form>
        </div>
    </div>


    <div class="client-data">
        <div class="data-header">
            <h4>Client Information</h4>
        </div>
        <div class="data-item">
            <input type="text" name="client.name.first" id="clientFirstName" placeholder="First Name">
        </div>
        <div class="data-item">
            <input type="text" name="client.name.last" id="clientLastName" placeholder="Last Name">
        </div>
        <div class="data-item">
            <input type="text" name="client.address.line_1" id="clientAddressLine1" placeholder="Street Line 1">
        </div>
        <div class="data-item">
            <input type="text" name="client.address.line_2" id="clientAddressLine2" placeholder="Street Line 2">
        </div>
        <div class="data-item">
            <input type="text" name="client.address.city" id="clientCity" placeholder="City">
        </div>
        <div class="data-row">
            <div class="data-item">
                <input type="text" name="client.address.state" id="clientState" placeholder="State (2 Letters)">
            </div>
            <div class="data-item">
                <input type="text" name="client.address.zip" id="clientZip" placeholder="Zip">
            </div>
        </div>
        <div class="data-item">
            <input type="tel" name="client.contact.phone" id="clientPhone" placeholder="Phone">
        </div>
        <div class="data-item">
            <input type="email" name="client.contact.email" id="clientEmail" placeholder="Email">
        </div>
    </div>



    <div class="expense-data">
        <div class="data-header">
            <h4>Expenses</h4>
        </div>
        <div class="data-header">
            <h6>Add New Expense</h6>
        </div>
        <div class="add-form">
            <form id="addNewExpenseForm" action="#" method="post">
                <div class="data-item"><input type="number" placeholder="Quantity"></div>
                <div class="data-item"><input type="number" placeholder="Price Each"></div>
                <div class="data-item"><button type="submit">Add Expense</button></div>
            </form>
        </div>
        <div class="data-header">
            <h6>All Current Expenses</h6>
        </div>
        <div class="expense-item">
            <div class="item-number">
                <span>1</span>
            </div>
            <div class="item-options">
                <span class="item-options-open"><img src="/images/menu.png" alt="Menu Icon"></span>
                <div class="item-options-list hidden">
                    <div class="options-list">
                        <span>Edit</span>
                        <span>Share</span>
                        <span>X</span>
                    </div>
                </div>
            </div>
            <div class="item-name">
                <p>Item 1</p>
            </div>
            <div class="item-description">
                <p>Item description goes here...</p>
            </div>
            <div class="item-details">
                <table>
                    <thead>
                        <tr>
                            <th>Qty</th>
                            <th>Price/Ea</th>
                            <th>Total</th>
                            <th>Paid</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>
                                <div class="item-quantity">6</div>
                            </td>
                            <td>
                                <div class="item-price-each">$50</div>
                            </td>
                            <td>
                                <div class="item-price-total">$300</div>
                            </td>
                            <td>
                                <div class="item-paid">$300</div>
                            </td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>

        <div class="expense-item">
            <div class="item-number">
                <span>2</span>
            </div>
            <div class="item-options">
                <span class="item-options-open"><img src="/images/menu.png" alt="Menu Icon"></span>
                <div class="item-options-list hidden">
                    <div class="options-list">
                        <span>Edit</span>
                        <span>Share</span>
                        <span>X</span>
                    </div>
                </div>
            </div>
            <div class="item-name">
                <p>Item 2</p>
            </div>
            <div class="item-description">
                <p>Item description goes here...</p>
            </div>
            <div class="item-details">
                <table>
                    <thead>
                        <tr>
                            <th>Qty</th>
                            <th>Price/Ea</th>
                            <th>Total</th>
                            <th>Paid</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>
                                <div class="item-quantity">52</div>
                            </td>
                            <td>
                                <div class="item-price-each">$150</div>
                            </td>
                            <td>
                                <div class="item-price-total">$7800</div>
                            </td>
                            <td>
                                <div class="item-paid">$5300</div>
                            </td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>

        <div class="expense-item">
            <div class="item-number">
                <span>3</span>
            </div>
            <div class="item-options">
                <span class="item-options-open"><img src="/images/menu.png" alt="Menu Icon"></span>
                <div class="item-options-list hidden">
                    <div class="options-list">
                        <span>Edit</span>
                        <span>Share</span>
                        <span>X</span>
                    </div>
                </div>
            </div>
            <div class="item-name">
                <p>Item 3</p>
            </div>
            <div class="item-description">
                <p>Item description goes here...</p>
            </div>
            <div class="item-details">
                <table>
                    <thead>
                        <tr>
                            <th>Qty</th>
                            <th>Price/Ea</th>
                            <th>Total</th>
                            <th>Paid</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>
                                <div class="item-quantity">1000</div>
                            </td>
                            <td>
                                <div class="item-price-each">$2.50</div>
                            </td>
                            <td>
                                <div class="item-price-total">$2500</div>
                            </td>
                            <td>
                                <div class="item-paid">$0</div>
                            </td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>

    </div>


</main>

<div class="notes-container">
    <div class="data-header">
        <h4>Notes</h4>
    </div>
    <div class="item-note" data-item-ref="2">
        <div class="item-ref">
            <span>2</span>
        </div>
        <div class="item-ref-options">
            <span class="item-ref-options-open">
                <img src="/images/menu.png" alt="Menu Icon">
            </span>
            <div class="item-ref-options-list">
                <div class="item-options-list hidden">
                    <div class="options-list">
                        <span>Edit</span>
                        <span>Share</span>
                        <span>X</span>
                    </div>
                </div>
            </div>
        </div>
        <div class="note-body">
            <p>This is where you can type in an extra long note to save space on your expenses list. You can add notes
                to however many notes you need to any items.</p>
        </div>
        <div class="dev-note">
            <p>This will all be done with forms that popup when a user clicks on certain buttons with dynamic item-data
                injected to each note for referencing.</p>
        </div>
    </div>
    <div class="item-note" data-item-ref="2">
        <div class="item-ref">
            <span>2</span>
        </div>
        <div class="item-ref-options">
            <span class="item-ref-options-open">
                <img src="/images/menu.png" alt="Menu Icon">
            </span>
            <div class="item-options-list hidden">
                <div class="options-list">
                    <span>Edit</span>
                    <span>Share</span>
                    <span>X</span>
                </div>
            </div>
        </div>
        <div class="note-body">
            <p>The number to the top left corner of this text is the number of the items number in the expenses list.
                You can find the item number in the same place as this item reference number on the item itself.</p>
        </div>
        <div class="dev-note">
            <p>This will all be done with forms that popup when a user clicks on certain buttons with dynamic item-data
                injected to each note for referencing.</p>
        </div>
    </div>

</div>

<footer>
    <ul>
        <li>O'Connell Inc.</li>
        <li><a href="tel:123456790">(123)456-7890</a></li>
        <li><a href="tel:0987654321">(098)765-4321</a></li>
        <li><a href="mailto:john@doe.com">john@doe.com</a></li>
    </ul>
</footer>

</div>


<script>
    const newJobForm = document.querySelector('#addNewJob')

    // Example POST method implementation:
    async function postData(url = '', data = {}) {
        // Default options are marked with *
        const response = await fetch(url, {
            method: 'POST', // *GET, POST, PUT, DELETE, etc.
            mode: 'cors', // no-cors, *cors, same-origin
            cache: 'no-cache', // *default, no-cache, reload, force-cache, only-if-cached
            credentials: 'same-origin', // include, *same-origin, omit
            headers: {
                'Content-Type': 'application/json'
                // 'Content-Type': 'application/x-www-form-urlencoded',
            },
            redirect: 'follow', // manual, *follow, error
            referrerPolicy: 'no-referrer', // no-referrer, *no-referrer-when-downgrade, origin, origin-when-cross-origin, same-origin, strict-origin, strict-origin-when-cross-origin, unsafe-url
            body: JSON.stringify(data) // body data type must match "Content-Type" header
        });
        return response.json(); // parses JSON response into native JavaScript objects
    }


    const 
        siteName = document.getElementById('siteName'),
        propertyType = document.getElementById('propertyType'),
        jobAddr1 = document.getElementById('jobAddr1'),
        jobAddr2 = document.getElementById('jobAddr2'),
        jobCity = document.getElementById('jobCity'),
        jobState = document.getElementById('jobState'),
        jobZip = document.getElementById('jobZip'),
        jobCountry = document.getElementById('jobCountry')
        
        newJobForm.addEventListener('submit', e => {
            e.preventDefault()


            const job = {
                "property.site_name": siteName.value,
                "property.zoning": propertyType.value,
                "property.address_line_1": jobAddr1.value,
                "property.address_line_2": jobAddr2.value,
                "property.city": jobCity.value,
                "property.state": jobState.value,
                "property.zip": jobZip.value,
                "property.country": jobCountry.value
            }
            console.log('job: ', job)
            postData('http://localhost:5000/jobs/create-new', job)
            .then((data) => {
                console.log(data); // JSON data parsed by `data.json()` call
            });
            siteName.value = ''
            jobAddr1.value = ''
            jobAddr2.value = ''
            jobCity.value = ''
            jobState.value = ''
            jobZip.value = ''
            jobCountry.value = ''
            let defaultJobZone = document.querySelector('#defaultJobZone')
            defaultJobZone.selected = true

        })

    // const data = { username: 'example' };

    // fetch('https://example.com/profile', {
    //     method: 'POST', // or 'PUT'
    //     headers: {
    //         'Content-Type': 'application/json',
    //     },
    //     body: JSON.stringify(data),
    // })
    //     .then((response) => response.json())
    //     .then((data) => {
    //         console.log('Success:', data);
    //     })
    //     .catch((error) => {
    //         console.error('Error:', error);
    //     });
</script>